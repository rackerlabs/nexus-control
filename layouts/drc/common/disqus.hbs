{{!
  Load script if the metadata envelope contains a "disqus" element with "include" set to true.
  Use the embed script if its "embed" property is true. Otherwise, render the "count" script.
}}

{{#if metadata.disqus.include}}
<script type="text/javascript">
  var disqus_shortname = '{{ metadata.disqus.short_name }}';

  {{#if metadata.disqus.embed }}
    // var disqus_developer = 1;
    var disqus_identifier = '{{ presented_url }}';
    var disqus_url = '{{ presented_url }}';
    var disqus_script = 'embed.js';
  {{else}}
    var disqus_script = 'count.js';
  {{/if}}

  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>
{{/if}}
